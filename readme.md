El codigo actualmente quedo con core dump pero funciona bastante bien exceptuando las efectividades
